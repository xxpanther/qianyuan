(function(B){var A=B(document).data("func",{});B.smartMenu=B.noop;B.fn.smartMenu=function(I,E){var F=B("body"),C={name:"",offsetX:2,offsetY:2,textLimit:6,beforeShow:B.noop,afterShow:B.noop};var H=B.extend(C,E||{});var G=function(O){var N=O||I,K=O?Math.random().toString():H.name,J="",M="",L="smart_menu_";if(B.isArray(N)&&N.length){J='<div id="smartMenu_'+K+'" class="'+L+'box"><div class="'+L+'body"><ul class="'+L+'ul">';B.each(N,function(P,Q){if(P){J=J+'<li class="'+L+'li_separate">&nbsp;</li>'}if(B.isArray(Q)){B.each(Q,function(X,S){var U=S.text,T="",W="",R=Math.random().toString().replace(".","");if(U){if(U.length>H.textLimit){U=U.slice(0,H.textLimit)+"â€¦";W=' title="'+S.text+'"'}if(B.isArray(S.data)&&S.data.length){T='<li class="'+L+'li" data-hover="true">'+G(S.data)+'<a href="javascript:" class="'+L+'a"'+W+' data-key="'+R+'"><i class="'+L+'triangle"></i>'+U+"</a></li>"}else{T='<li class="'+L+'li"><a href="javascript:" class="'+L+'a"'+W+' data-key="'+R+'">'+U+"</a></li>"}J+=T;var V=A.data("func");V[R]=S.func;A.data("func",V)}})}});J=J+"</ul></div></div>"}return J},D=function(){var L="#smartMenu_",J="smart_menu_",K=B(L+H.name);if(!K.size()){B("body").append(G());B(L+H.name+" a").bind("click",function(){var N=B(this).attr("data-key"),M=A.data("func")[N];if(B.isFunction(M)){M.call(A.data("trigger"))}B.smartMenu.hide();return false});B(L+H.name+" li").each(function(){var M=B(this).attr("data-hover"),N=J+"li_hover";B(this).hover(function(){var O=B(this).siblings("."+N);O.removeClass(N).children("."+J+"box").hide();O.children("."+J+"a").removeClass(J+"a_hover");if(M){B(this).addClass(N).children("."+J+"box").show();B(this).children("."+J+"a").addClass(J+"a_hover")}})});return B(L+H.name)}return K};B(this).each(function(){this.oncontextmenu=function(J){if(B.isFunction(H.beforeShow)){H.beforeShow.call(this)}J=J||window.event;J.cancelBubble=true;if(J.stopPropagation){J.stopPropagation()}B.smartMenu.hide();var K=A.scrollTop();var L=D();if(L){L.css({display:"block",left:J.clientX+H.offsetX,top:J.clientY+K+H.offsetY});A.data("target",L);A.data("trigger",this);if(B.isFunction(H.afterShow)){H.afterShow.call(this)}return false}}});if(!F.data("bind")){F.bind("click",B.smartMenu.hide).data("bind",true)}};B.extend(B.smartMenu,{hide:function(){var C=A.data("target");if(C&&C.css("display")==="block"){C.hide()}},removeevent:function(C){var D=A.data("target");if(D){D.remove();if(B.isFunction(C)){C.call(this)}}},remove:function(){var C=A.data("target");if(C){C.remove()}}})})(jQuery);